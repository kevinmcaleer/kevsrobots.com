---
layout: content
title: Search Results 
---
{% include breadcrumbs.html %}
    <h1>Search Results</h1>
    <h2>Find articles, tutorials, how it works, projects, ideas and more.</h2>
    <p id="search-query-display">Showing Results for: <span id="search-query"></span><br />
    About <span id="total_count"></span> results (<span id="search-time"></span>)</p>

    <hr />
    <div id="results-container"></div>
    <script>
    function createPagination(totalCount, pageSize, currentPage, query) {
        const totalPages = Math.ceil(totalCount / pageSize);
        const paginationContainer = document.getElementById('pagination-container');
        paginationContainer.innerHTML = ''; // Clear existing pagination links
    
        for (let i = 1; i <= totalPages; i++) {
            const pageLink = document.createElement('a');
            // pageLink.href = 'http://0.0.0.0:4000/search-results?query=' + query + '&page=' + i;
            pageLink.href = 'https://www.kevsrobots.com/search-results?query=' + query + '&page=' + i;
            pageLink.innerText = i;
            pageLink.classList.add('pagination-link');
            if (i === currentPage) {
                pageLink.classList.add('active');
            }
    
            pageLink.addEventListener('click', function (e) {
                // e.preventDefault();
                performSearch(i);
            });
    
            paginationContainer.appendChild(pageLink);
        }
    }
    
    document.addEventListener('DOMContentLoaded', function() {
        var urlParams = new URLSearchParams(window.location.search);
        var query = urlParams.get('query');
        var page = urlParams.get('page');
        if (page == null) {
            page = 1;
            console.log("Page was null, setting to 1");
        }

         // Set the search query in the "Showing Results for" section
        if (query) {
            document.getElementById('search-query').textContent = query;
        } else {
            document.getElementById('search-query-display').textContent = 'Showing All Results';
      
        }
        
        // Call your API to get the search results
        fetch('https://search.kevsrobots.com/search/?query=' + encodeURIComponent(query) + '&page=' + page)
        // fetch('http://0.0.0.0:8000/search/?query=' + encodeURIComponent(query) + '&page=' + page)
            .then(response => response.json())
            .then(data => { 
                 displayResults(data.results);
                 document.getElementById('total_count').textContent = data.total_count;
                 document.getElementById('search-time').textContent = data.execution_time + ' seconds';
                 console.log(data);
                 createPagination(data.total_count, data.page_size, data.current_page, query);
                })
                 
            .catch(error => console.error('Error:', error));
        
    });

    function displayResults(results) {
        var resultsContainer = document.getElementById('results-container');
        resultsContainer.innerHTML = ''; // Clear previous results

        // Define a default or placeholder image URL
        var defaultImage = '/assets/img/default_image.png'; // Update with the path to your default image

        // Display each result
        results.forEach(function(result) {
            var div = document.createElement('div');
            var imageUrl = result.cover_image && result.cover_image !== "https://www.kevsrobots.com/DefaultImagePath"
                        ? result.cover_image 
                        : defaultImage; // Use the default image if cover_image is not available
            // Format the date
            var publishedDate = new Date(result.date);
            var formattedDate = publishedDate.toLocaleDateString('en-US', {  day: 'numeric', month: 'long',year: 'numeric' });

            div.innerHTML = `<div class="row row-cols g-1 m-3">
                <div class="col">
                            <div class="row">
                            <div class="col-4 col-lg-2">
                                <img src="${imageUrl}" alt="Cover Image" class="img-fluid w-100" style="width=100px">
                            </div>
                            <div class="col-8 col-lg-10">
                            <p><b>${result.page_title}</b><br />
                            ${result.description} | Published: ${formattedDate}</p>
                            <a href="${result.url}">${result.url}</a>
                            </div>                    
                             </div>
                             </div><hr />`;
            resultsContainer.appendChild(div);
        });
    }
    </script>
    <div id="pagination-container"></div>

</body>
</html>
