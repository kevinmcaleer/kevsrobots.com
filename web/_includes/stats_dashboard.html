<!-- Stats Dashboard HTML Structure -->
<div class="stats-container">
    <!-- Summary Stats -->
    <div class="stats-grid">
        <div class="stat-card">
            <h3>Total Visits (Last Month)</h3>
            <div class="stat-value" id="totalVisits">-</div>
        </div>
        <div class="stat-card">
            <h3>Total Searches (Last Month)</h3>
            <div class="stat-value" id="totalSearches">-</div>
        </div>
        <div class="stat-card">
            <h3>Total Users (Last Month)</h3>
            <div class="stat-value" id="totalUsers">-</div>
        </div>
        <div class="stat-card">
            <h3>Returning Users</h3>
            <div class="stat-value" id="returningUsers">-</div>
        </div>
    </div>

    <!-- Daily Visits and Searches Side by Side -->
    <div class="chart-row-2">
        <div class="chart-container">
            <h2>Daily Visits (Last Year)</h2>
            <div class="chart-wrapper-medium">
                <canvas id="visitsPerDayChart"></canvas>
            </div>
        </div>

        <div class="chart-container">
            <h2>Searches Over Time (Last Year)</h2>
            <div class="chart-wrapper-medium">
                <canvas id="searchesPerDayChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Pie Charts and Country Breakdown Side by Side -->
    <div class="chart-row-2">
        <!-- Three Pie Charts Side by Side in One Container -->
        <div class="chart-container">
            <h2>Breakdown by Device, OS, and Content Type</h2>
            <div class="pie-chart-grid">
                <div class="pie-chart-item">
                    <h3>Device</h3>
                    <div class="chart-wrapper-tiny">
                        <canvas id="deviceChart"></canvas>
                    </div>
                </div>
                <div class="pie-chart-item">
                    <h3>OS</h3>
                    <div class="chart-wrapper-tiny">
                        <canvas id="osChart"></canvas>
                    </div>
                </div>
                <div class="pie-chart-item">
                    <h3>Content</h3>
                    <div class="chart-wrapper-tiny">
                        <canvas id="pageTypeChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Country Breakdown -->
        <div class="chart-container">
            <h2>Visitors by Country (Last 30 Days)</h2>
            <div class="chart-wrapper">
                <canvas id="countryChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Search Lists and Popular Pages Side by Side -->
    <div class="chart-row-3">
        <div class="chart-container">
            <h2>Top Searches This Week</h2>
            <ul class="query-list" id="topSearchesWeek"></ul>
        </div>

        <div class="chart-container">
            <h2>Trending Searches (Week-over-Week)</h2>
            <ul class="query-list" id="trendingSearches"></ul>
        </div>

        <div class="chart-container">
            <h2>Most Popular Pages (Last 30 Days)</h2>
            <ul class="query-list" id="popularPages"></ul>
        </div>
    </div>

    <!-- Viral Detection Section -->
    <div class="section-header">
        <h2>Viral Content Detection</h2>
        <p class="section-description">Automated detection of unusual traffic patterns and viral content</p>
    </div>

    <!-- Traffic Anomalies Alert -->
    <div class="chart-container alert-container" id="anomalyAlert" style="display: none;">
        <h2>üî• Traffic Anomalies Detected</h2>
        <p class="alert-subtitle">Pages with unusual traffic spikes in the last 48 hours</p>
        <ul class="query-list" id="trafficAnomalies"></ul>
    </div>

    <!-- Geographic Shifts Alert -->
    <div class="chart-container alert-container" id="geoShiftAlert" style="display: none;">
        <h2>üåç Geographic Traffic Shifts</h2>
        <p class="alert-subtitle">Countries with unusual traffic increases</p>
        <ul class="query-list" id="geographicShifts"></ul>
    </div>

    <!-- Trending Pages and New Visitor Surge Side by Side -->
    <div class="chart-row-2">
        <div class="chart-container">
            <h2>Trending Pages (Week-over-Week)</h2>
            <ul class="query-list" id="trendingPages"></ul>
        </div>

        <div class="chart-container">
            <h2>New vs Returning Visitors</h2>
            <div class="chart-wrapper-medium">
                <canvas id="newVisitorChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Bot Traffic and Hourly Heatmap Side by Side -->
    <div class="chart-row-2">
        <div class="chart-container">
            <h2>Bot vs Human Traffic</h2>
            <div class="chart-wrapper-medium">
                <canvas id="botHumanChart"></canvas>
            </div>
        </div>

        <div class="chart-container">
            <h2>Hourly Traffic Heatmap (Last 7 Days)</h2>
            <div class="chart-wrapper-medium">
                <canvas id="hourlyHeatmap"></canvas>
            </div>
        </div>
    </div>

    <div class="last-updated" id="lastUpdated">
        Loading data...
    </div>
</div>

<!-- Load Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<!-- Load Dashboard JavaScript -->
<script>
{% include stats_dashboard.js %}
</script>
